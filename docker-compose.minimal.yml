# This docker compose file is a minimal override file that goes with
# docker-compose.yml and is intended to be used when you want to run a one-off
# temporary command on the web service without spawning the entire environment.
# This is used by CI to run tests without having to run "make up".

services:
  web:
    healthcheck: !override
      test: ['CMD','true']
    depends_on: !override
      mysqld:
        condition: service_healthy
      memcached:
        condition: service_started
      redis:
        condition: service_started
      # FIXME: consider tagging autograph tests and avoid depending on it in
      # test_main(x), running them separately like we do for elasticsearch.
      autograph:
        condition: service_started
