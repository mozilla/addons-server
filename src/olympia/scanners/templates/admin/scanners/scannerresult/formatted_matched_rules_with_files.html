{% load admin_urls %}
{% load code_manager_tags %}
{# This template can be used for both scanner results and scanner query results. Keep it generic. #}

<table>
  <thead>
    <tr>
      <th>Rule name</th>
      <th>Files</th>
    </tr>
  </thead>
  {% for rule in matched_rules %}
  <tr>
    <td><a href="{% url rule_change_urlname rule.pk %}">{{ rule.name }}</a></td>
    <td>
      {% for file in rule.files %}
        {% if file_id %}
          <a href="{% code_manager_url 'browse' addon_id version_id file=file %}">
            {{ file }}
          </a>
        {% else %}
          {{ file }}
        {% endif %}
        <br>
      {% endfor %}
    </td>
  </tr>
  {% endfor %}
</table>
